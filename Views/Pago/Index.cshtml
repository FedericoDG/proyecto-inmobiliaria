@if (TempData["Mensaje"] != null)
{
  <div class="alert alert-success alert-dismissible fade show text-center" role="alert">
    @TempData["Mensaje"]
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
  </div>
}

@if (TempData["Error"] != null)
{
  <div class="alert alert-danger alert-dismissible fade show text-center" role="alert">
    @TempData["Error"]
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
  </div>
}
@model IEnumerable<inmobiliaria.Models.Pago>
@{
  ViewData["Title"] = "Lista de Pagos";
  Layout = "~/Views/Panel/_Layout.cshtml";
}

@if (TempData["Mensaje"] != null)
{
  <div class="alert alert-success alert-dismissible fade show text-center" role="alert">
    @TempData["Mensaje"]
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
  </div>
}

<div class="row mb-4">
  <div class="col-12">
    <div class="card shadow-sm border-0 bg-primary text-white">
      <div class="card-body d-flex align-items-center justify-content-between">
        <div>
          <h1 class="card-title mb-0 fs-3">
            <i class="bi bi-cash-coin me-2"></i>Pagos
          </h1>
          <small class="text-white-50">Listado de todos los pagos registrados</small>
        </div>
        <a class="btn btn-light btn-lg" href="/panel/pagos/crear">
          <i class="bi bi-plus-square-fill me-1"></i> Nuevo pago
        </a>
      </div>
    </div>
  </div>
</div>

<div class="table-responsive mb-3">
  <table class="table table-hover align-middle shadow-sm">
    <thead class="table-primary">
      <tr>
        <th scope="col">ID</th>
        <th scope="col">Contrato</th>
        <th scope="col">Número</th>
        <th scope="col">Fecha</th>
        <th scope="col">Importe</th>
        <th scope="col">Estado</th>
        <th scope="col" class="text-center">Acciones</th>
      </tr>
    </thead>
    <tbody>
      @foreach (var p in Model)
      {
        <tr>
          <td>@p.IdPago</td>
          <td>@p.IdContrato</td>
          <td>@p.NumeroPago</td>
          <td>@p.FechaPago.ToShortDateString()</td>
          <td>$@p.Importe</td>
          <td>@p.Estado</td>
          <td class="text-center">
            <a class="btn btn-outline-primary btn-sm me-1" href="/panel/pagos/editar/@p.IdPago" title="Editar">
              <i class="bi bi-pencil-square"></i>
            </a>
            <form method="post" action="/panel/pagos/eliminar/@p.IdPago" style="display:inline">
              <button type="submit" class="btn btn-outline-danger btn-sm" title="Eliminar">
                <i class="bi bi-trash"></i>
              </button>
            </form>
          </td>
        </tr>
      }
    </tbody>
  </table>
</div>

<nav aria-label="Paginación">
  <ul class="pagination justify-content-center">
    <li class="page-item @(ViewBag.Page <= 1 ? "disabled" : "")">
      <a class="page-link" href="?page=@(ViewBag.Page - 1)&pageSize=@ViewBag.PageSize">Anterior</a>
    </li>
    @for (int i = 1; i <= ViewBag.TotalPages; i++)
    {
      <li class="page-item @(i == ViewBag.Page ? "active" : "")">
        <a class="page-link" href="?page=@i&pageSize=@ViewBag.PageSize">@i</a>
      </li>
    }
    <li class="page-item @(ViewBag.Page >= ViewBag.TotalPages ? "disabled" : "")">
      <a class="page-link" href="?page=@(ViewBag.Page + 1)&pageSize=@ViewBag.PageSize">Siguiente</a>
    </li>
  </ul>
</nav>

@section Scripts {
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
}
